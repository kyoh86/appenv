// Code generated by github.com/kyoh86/appenv.Generator DO NOT EDIT.

package out

import (
	keyring "github.com/99designs/keyring"
	def "github.com/kyoh86/appenv/internal/def"
)

type Keyring struct {
	Token *def.Token
}

func loadKeyring(keyringConfig *keyring.Config) (key Keyring, err error) {
	if keyringConfig == nil {
		return
	}
	{
		ring, err := keyring.Open(*keyringConfig)
		if err == nil {
			item, err := ring.Get("token")
			if err == nil {
				var value def.Token
				if err = value.UnmarshalText(item.Data); err != nil {
					return key, err
				}
				key.Token = &value
			}
		}
	}
	return
}

func saveKeyring(keyringConfig *keyring.Config, key *Keyring) (err error) {
	if keyringConfig == nil {
		return
	}
	{
		ring, err := keyring.Open(*keyringConfig)
		if err != nil {
			return err
		}
		buf, err := key.Token.MarshalText()
		if err != nil {
			return err
		}
		if err := ring.Set(keyring.Item{

			Data: buf,
			Key:  "token",
		}); err != nil {
			return err
		}
	}
	return nil
}
